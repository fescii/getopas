{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% endblock %}</title>
    <link href="{% static "css/global.css" %}" rel="stylesheet">
    <link href="{% static "css/footer.css" %}" rel="stylesheet">
    <link href="{% static "css/main.css" %}" rel="stylesheet">
    <link href="{% static "css/header.css" %}" rel="stylesheet">
    <link href="{% static "css/responsive.css" %}" rel="stylesheet">
    <link href="{% static "css/style.css" %}" rel="stylesheet">
    <link href="https://fonts.cdnfonts.com/css/product-sans" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css">
</head>

<body class="feeds-body">
    {% if messages %}
        <ul class="messages">
            {% for message in messages %}
                <li class="{{ message.tags }}">
                    {{ message|safe }}
                    <span href="#" class="close">x</span>
                </li>
        {% endfor %}
        </ul>
    {% endif %}
    <main class="feeds {{ section }}">
        <button type="button" class="hamburger">
            <span class="line"></span>
            <span class="line"></span>
            <span class="line"></span>
        </button>
        <div class="dashboard-sidebar">
            <div class="logo-container">
                <div class="site-logo">
                    <img src="/media/img/favi.png" alt="Logo" />
                </div>
            </div>
            <div class="sidebar-nav">
                <div class="content-nav">
                    <ul class="linked-list content-list">
                        <li class="content-link">
                            <a class="link {% if section == 'home' %}data-active{% endif %}" href=" {% url 'editors:dashboard' %}">
                                <span id="select"></span>
                                <span class="iconly-Home icli"></span>
                                <span class="link-text">Home</span>
                            </a>
                        </li>
                        <li class="content-link">
                            <a class="link {% if section == 'create' %}data-active{% endif %}" href=" {% url 'editors:create_post' %}">
                                <span id="select"></span>
                                <span class="iconly-Plus icli"></span>
                                <span class="link-text">Create</span>
                            </a>
                        </li>
                        <li class="content-link">
                            <a class="link {% if section == 'search' %}data-active{% endif %}" href="{% url 'editors:user_issue_list' %}">
                                <span id="select"></span>
                                <span class="iconly-Search icli"></span>
                                <span class="link-text">Search</span>
                            </a>
                        </li>
                        <li class="content-link">
                            <a class="link {% if section == 'products' %}data-active{% endif %}" href="{% url 'editors:user_product_list' %}">
                                <span id="select"></span>
                                <span class="iconly-Bag-2 icli"></span>
                                <span class="link-text">Products</span>
                            </a>
                        </li>
                        <li class="content-link">
                            <a class="link {% if section == 'explore' %}data-active{% endif %}" href="#">
                                <span id="select"></span>
                                <span class="iconly-Discovery icli"></span>
                                <span class="link-text">Explore</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="hr"></div>
                <div class="settings-nav">
                    <ul class="linked-list settings-list">
                        <li class="content-link">
                            <a class="link {% if section == 'profile' %}data-active{% endif %}" href=" {% url 'profile' username=user.username %}">
                                <span id="select"></span>
                                <span class="iconly-Profile icli"></span>
                                <span class="link-text">Profile</span>
                            </a>
                        </li>
                        <li class="content-link">
                            <a class="link {% if section == 'my-list' %}data-active{% endif %}" href="{% url 'editors:my_list' %}">
                                <span id="select"></span>
                                <span class="iconly-Bookmark icli"></span>
                                <span class="link-text">My List</span>
                            </a>
                        </li>
                        <li class="content-link">
                            <a class="link {% if section == 'themes' %}data-active{% endif %}" href="#">
                                <span id="select"></span>
                                <span class="iconly-Info-Circle icli"></span>
                                <span class="link-text">Themes</span>
                            </a>
                        </li>
                        <li class="content-link">
                            <a class="link {% if section == 'donate' %}data-active{% endif %}" href="#">
                                <span id="select"></span>
                                <span class="iconly-Heart icli"></span>
                                <span class="link-text">Donate</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        {% block content %}
        {% endblock %}
    </main>
    <div class="mobile-footer">
        <a href="" title="Home" class="mobile-footer-link">
            <span class="iconly-Home icli"></span>
        </a>
        <a href="" title="Search" class="mobile-footer-link">
            <span class="iconly-Search icli"></span>
        </a>
        <a href="" title="Search" class="mobile-footer-link">
            <span class="iconly-Message icli"></span>
        </a>
        <a href="" title="Products" class="mobile-footer-link">
            <span class="iconly-Bag-2 icli"></span>
        </a>
        <a href="" title="Create" class="mobile-footer-link">
            <span class="iconly-Edit icli"></span>
        </a>
        <!--<a href="" title="Create" class="mobile-footer-link active">
            <span class="iconly-Profile icli"></span>
        </a>-->
    </div>
    <script src=" {% static 'js/dropdown.js' %}"></script>
    <script src="//cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>
    <script>
        const csrftoken = Cookies.get('csrftoken');
        document.addEventListener('DOMContentLoaded', (event) => {
            // DOM loaded
            {% block domready %}
            {% endblock %}
            const url = '{% url "editors:save" %}';
            let options = {
                method: 'POST',
                headers: {'X-CSRFToken': csrftoken},
                mode: 'same-origin'
            }
            saveButtons = document.querySelectorAll('a.save')
            saveButtons.forEach(saveButton =>{
                saveButton.addEventListener('click', function(e){
                    e.preventDefault();

                    // add request body
                    let formData = new FormData();
                    formData.append('id', saveButton.dataset.id);
                    formData.append('action', saveButton.dataset.action);
                    options['body'] = formData;

                    // send HTTP request
                    fetch(url, options).then(response => response.json()).then(data => {
                        if (data['status'] === 'ok'){
                            let previousAction = saveButton.dataset.action;

                            // toggle button text and data-action
                            let action = previousAction === 'Save' ? 'Remove' : 'Save';
                            saveButton.dataset.action = action;
                            saveButton.classList.add("Remove")
                            saveButton.innerHTML = `<span>${action}</span>`;

                            // update save count
                        /* let saveCount = document.querySelector('span.count .total');
                            let totalSaves = parseInt(saveCount.innerHTML);
                            saveCount.innerHTML = previousAction === 'save' ? totalSaves + 1 :totalSaves - 1;*/
                        }
                    });
                });
            });
        });
    </script>
    {% block footer %}
    {% endblock footer %}
</body>

</html>